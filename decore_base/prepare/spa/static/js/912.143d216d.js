"use strict";(globalThis["webpackChunkuniform_front"]=globalThis["webpackChunkuniform_front"]||[]).push([[912],{5912:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Lt});var s=l(9835),a=l(499),i=(l(9665),l(5360)),o=l(8339);class n extends i.y{constructor(e){super(e),this.route_dialog_s=[],this.setRouteDialogs(this.getView())}getView(){let e,t=(0,o.yj)();return this.view_s.forEach((l=>{l.id==t.params.view_id&&(e=l)})),e}setRouteDialogs(e){e.dialog_s.forEach((e=>{this.route_dialog_s.push(e),e.widget_s.forEach((e=>{this.setRouteDialogs(e)}))}))}}var u=l(4629);class r extends i.y{constructor(e){super(e),this.ql={},this.action_store=(0,u.j)(),this.context="none",this.show=!1,this.has_submit_btn=!1,this.has_close_btn=!1}setSubmitBtn(){let e=!1;this.widget_s.forEach((t=>{t.action_s.forEach((t=>{"item-submit"==t.activator&&(e=!0)}))})),this.has_submit_btn=e}setCloseBtn(){let e=!1;"last"!=this.context&&(e=!0),this.has_close_btn=e}async getCheckResult(){let e=!0;for(const t of this.action_s)if("check"==t.type){let l=await this.action_store.postCheckAction(t,void 0,void 0);e=l["success"];break}return e}async showDialog(e,t,l){this.context=t;let s=await this.getCheckResult();s&&(this.setCloseBtn(),this.setSubmitBtn(),this.widget_s.forEach((s=>{this.ref[s.id].initWidget(e,t,l),s.widget_s.forEach((s=>{this.ref[s.id].initWidget(e,t,l)}))})),this.show=!0)}submitWidgets(){this.widget_s.forEach((e=>{this.ref[e.id].submit(),e.widget_s.forEach((e=>{this.ref[e.id].submit()}))}))}closeDialog(){this.show=!1,this.widget_s.forEach((e=>{this.ref[e.id].reset(),e.widget_s.forEach((e=>{this.ref[e.id].reset()}))}))}}var d=l(6970),c=l(5288);const m={class:"dialog-content"},p={inheritAttrs:!1},h=Object.assign(p,{__name:"uf-dialog-layout",setup(e){const t=(0,s.l1)().use,l=(0,s.Fl)((()=>{let e="none";return t.show&&(e="block"),e}));(0,s.Fl)((()=>{let e="sub-dialog";return t.ref[t.parent_id].class.includes("view")&&(e="main-dialog"),e}));return(e,i)=>{const o=(0,s.up)("q-toolbar-title"),n=(0,s.up)("q-space"),u=(0,s.up)("q-btn"),r=(0,s.up)("q-toolbar"),p=(0,s.up)("q-header"),h=(0,s.up)("q-footer"),_=(0,s.up)("q-layout");return(0,s.wg)(),(0,s.iD)("div",{style:(0,d.j5)({display:(0,a.SU)(l)})},[(0,s.Wm)(_,{container:"",style:{height:"calc(100vh - 102px)"}},{default:(0,s.w5)((()=>[(0,s.Wm)(c.Z,{use:(0,a.SU)(t)},null,8,["use"]),(0,s.Wm)(p,{reveal:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"text-black"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)((0,a.SU)(t).title),1)])),_:1}),(0,s.Wm)(n),(0,a.SU)(t).has_close_btn?((0,s.wg)(),(0,s.j4)(u,{key:0,class:"text-black",round:"",flat:"",dense:"",onClick:i[0]||(i[0]=e=>(0,a.SU)(t).closeDialog()),icon:"close"})):(0,s.kq)("",!0)])),_:1})])),_:1}),(0,s._)("div",m,[(0,s.WI)(e.$slots,"dialog-content")]),(0,s.Wm)(h,{reveal:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,a.SU)(t).has_submit_btn?((0,s.wg)(),(0,s.j4)(u,{key:0,class:"text-black",label:"Submit",flat:"",onClick:i[1]||(i[1]=e=>(0,a.SU)(t).submitWidgets())})):(0,s.kq)("",!0),(0,a.SU)(t).has_close_btn?((0,s.wg)(),(0,s.j4)(u,{key:1,class:"text-black",label:"Close",flat:"",onClick:i[2]||(i[2]=e=>(0,a.SU)(t).closeDialog())})):(0,s.kq)("",!0)])),_:1})])),_:1})])),_:3})],4)}}});var _=l(7605),g=l(6602),w=l(1663),f=l(1973),v=l(136),b=l(8879),y=l(1378),k=l(9984),U=l.n(k);const q=h,S=q;U()(h,"components",{QLayout:_.Z,QHeader:g.Z,QToolbar:w.Z,QToolbarTitle:f.Z,QSpace:v.Z,QBtn:b.Z,QFooter:y.Z});const W={inheritAttrs:!1},j=Object.assign(W,{__name:"uf-dialog-display",setup(e){const t=(0,s.l1)().use,l=(0,s.Fl)((()=>{let e=t.ref.app.ql.totalWidth-t.ref.app.ql.left.offset;return e}));return(e,i)=>{const o=(0,s.up)("q-drawer");return"drawer"==(0,a.SU)(t).display?((0,s.wg)(),(0,s.j4)(o,{key:0,modelValue:(0,a.SU)(t).show,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,a.SU)(t).show=e),elevated:"",overlay:"",side:"right",breakpoint:0,width:.5*(0,a.SU)(l)},{default:(0,s.w5)((()=>[(0,s.Wm)(S,{use:(0,a.SU)(t)},{"dialog-content":(0,s.w5)((()=>[(0,s.WI)(e.$slots,"dialog-content")])),_:3},8,["use"])])),_:3},8,["modelValue","width"])):(0,s.kq)("",!0)}}});var D=l(3655);const Q=j,Z=Q;U()(j,"components",{QDrawer:D.Z});class F{constructor(e,t){this.source=e,this.query=t,this.search="",this.item={},this.item_s=[],this.select_s=[],this.count=0}setItems(){this.source.getItems(this.query).then((e=>{this.item_s=e.data.item_s,this.count=e.data.count})).catch((e=>{console.log(e)}))}}var V=l(1809);function C(e){const t=(0,V.Q_)(e,{state:()=>({el:{}}),getters:{},actions:{sendElement(e,t,l,s){let a={event:t,value:l,el:s};this.axios.post("/element/"+this.$id+"/"+e,a).then((e=>{this.el=e.data.el})).catch((e=>{console.log(e)}))}}}),l=t();return l}class x extends i.y{constructor(e){super(e),this.data=(0,a.qj)(new F(this.uniform.source[this.source_id],{})),this.compose_store=C(this.id),this.action_store=(0,u.j)(),this.form_ref=void 0,this.composer_ref=void 0,this.valid=!0,this.item_s_mode=!1}regComposerElement(e){e.id in this.item||(this.item[e.id]=e.default),e.schema&&(this.source.schema[e.id]=e.schema),this.compose_store.el[e.id]=e}refForm(e){this.form_ref=e}refComposer(e){this.composer_ref=e}initWidget(e,t,l){const s=t,a=l;this.data.item_s=[],"default"==s&&(this.data.item=this.data.source.default),"item"==s&&(this.data.source.model==a.model?this.data.item={...e}:(this.data.item=this.data.source.default,a.rel_field_s.forEach((t=>{if("ForeignKeyField"==t.class&&this.data.source.model==t.model){let l=t.name+"__eq";this.data.query[l]=e.id,this.data.item[t.name]={...e}}if("ManyToManyField"==t.class&&this.data.source.model==t.rel_model){let l=t.backref+"__id__eq";this.data.query[l]=e.id}})))),"last"==s&&this.data.source.getLast().then((e=>{this.data.item=e.data})),this.item_s_mode&&this.data.setItems(),this.element_s.forEach((e=>{this.regComposerElement(e)}))}async validateWidget(){this.form_ref&&await this.form_ref.validate().then((e=>{e||(this.valid=!1)})),this.composer_ref&&await this.composer_ref.validate().then((e=>{e||(this.valid=!1)}))}reset(){this.form_ref&&this.form_ref.reset(),this.composer_ref&&this.form_ref.reset()}async submit(){await this.validateWidget(),this.valid&&this.action_s.forEach((e=>{"item-submit"==e.activator&&this.action_store.sendAction(e,this.data.item,this.data.source.select_s)}))}getRules(e){let t=[];if(e in this.data.source.schema){const l=this.data.source.schema[e];"string"==l.type&&t.push((e=>e&&e.length>0||"Not valid")),"allowed"in l&&l.allowed.forEach((e=>{t.push((t=>t&&t==e||"Not valid"))}))}return t}}const E={key:0},K={key:1},H={key:2},z={key:3},O={key:4},I={key:5},A={inheritAttrs:!1},Y=Object.assign(A,{__name:"uf-widget-composer",setup(e){const t=(0,s.l1)().use;return(e,l)=>{const i=(0,s.up)("q-checkbox"),o=(0,s.up)("q-field"),n=(0,s.up)("q-form");return(0,s.wg)(),(0,s.j4)(n,{greedy:"",ref:e=>{(0,a.SU)(t).refComposer(e)}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).compose_store.el,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},["p"==e.type?((0,s.wg)(),(0,s.iD)("p",E,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"h1"==e.type?((0,s.wg)(),(0,s.iD)("h1",K,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"h2"==e.type?((0,s.wg)(),(0,s.iD)("h2",H,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"h3"==e.type?((0,s.wg)(),(0,s.iD)("h3",z,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"h4"==e.type?((0,s.wg)(),(0,s.iD)("h4",O,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"h5"==e.type?((0,s.wg)(),(0,s.iD)("h5",I,(0,d.zw)((0,a.SU)(t).item[e.id]),1)):(0,s.kq)("",!0),"checkbox"==e.type?((0,s.wg)(),(0,s.j4)(o,{key:6,"hide-bottom-space":"",dense:"",borderless:"",modelValue:(0,a.SU)(t).item[e.id],"onUpdate:modelValue":l=>(0,a.SU)(t).item[e.id]=l,rules:(0,a.SU)(t).getRules(e.id),"lazy-rules":"ondemand"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{modelValue:(0,a.SU)(t).item[e.id],"onUpdate:modelValue":[l=>(0,a.SU)(t).item[e.id]=l,l=>(0,a.SU)(t).compose_store.sendElement(e.id,"update",(0,a.SU)(t).item[e.id],(0,a.SU)(t).compose_store.el)],label:e.title,disable:e.disable},null,8,["modelValue","onUpdate:modelValue","label","disable"])])),_:2},1032,["modelValue","onUpdate:modelValue","rules"])):(0,s.kq)("",!0)])))),128))])),_:1},512)}}});var P=l(8326),T=l(8149),B=l(1006);const M=Y,R=M;U()(Y,"components",{QForm:P.Z,QField:T.Z,QCheckbox:B.Z});const L={key:0},$={key:1},N={key:2},G={inheritAttrs:!1},J=Object.assign(G,{__name:"uf-widget-layout",setup(e){const t=(0,s.l1)().use;return(e,l)=>{const i=(0,s.up)("q-space"),o=(0,s.up)("q-icon"),n=(0,s.up)("q-toolbar"),u=(0,s.up)("q-card-section"),r=(0,s.up)("q-btn"),c=(0,s.up)("q-card-actions"),m=(0,s.up)("q-separator"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(p,{class:"widget-card",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{class:"widget-card-toolbar"},{default:(0,s.w5)((()=>[(0,s._)("h5",null,(0,d.zw)((0,a.SU)(t).title),1),(0,s.Wm)(i),(0,s.Wm)(o,{name:(0,a.SU)(t).icon},null,8,["name"])])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).layout,(l=>((0,s.wg)(),(0,s.iD)("span",{key:l},["c"==l?((0,s.wg)(),(0,s.iD)("span",L,[(0,s.Wm)(u,{class:"widget-card-section"},{default:(0,s.w5)((()=>[(0,s.WI)(e.$slots,"widget-content")])),_:3})])):(0,s.kq)("",!0),"e"==l&&(0,a.SU)(t).element_s.length>=1?((0,s.wg)(),(0,s.iD)("span",$,[(0,s.Wm)(u,{class:"widget-card-section"},{default:(0,s.w5)((()=>[(0,s.Wm)(R,{use:(0,a.SU)(t)},null,8,["use"])])),_:1})])):(0,s.kq)("",!0),"a"==l?((0,s.wg)(),(0,s.iD)("span",N,[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).dialog_s,(l=>((0,s.wg)(),(0,s.iD)("span",{key:l.id},["default-menu"==l.activator?((0,s.wg)(),(0,s.j4)(r,{key:0,onClick:s=>e.uniform.dialog[l.id].showDialog(void 0,"default",(0,a.SU)(t).source),icon:l.icon,dense:"",flat:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)(l.title)+"...",1)])),_:2},1032,["onClick","icon"])):(0,s.kq)("",!0)])))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).action_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},["default-menu"==e.activator?((0,s.wg)(),(0,s.j4)(r,{key:0,icon:e.icon,dense:"",flat:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)(e.title)+"...",1)])),_:2},1032,["icon"])):(0,s.kq)("",!0)])))),128))])),_:1})])):(0,s.kq)("",!0)])))),128)),(0,s.Wm)(m)])),_:3})}}});var X=l(4458),ee=l(2857),te=l(3190),le=l(1821),se=l(926);const ae=J,ie=ae;U()(J,"components",{QCard:X.Z,QToolbar:w.Z,QSpace:v.Z,QIcon:ee.Z,QCardSection:te.Z,QCardActions:le.Z,QBtn:b.Z,QSeparator:se.Z});const oe={inheritAttrs:!1},ne=Object.assign(oe,{__name:"uf-widget-default",setup(e){(0,s.l1)().use;return(e,t)=>((0,s.wg)(),(0,s.iD)("span"))}}),ue=ne,re=ue,de={inheritAttrs:!1},ce=Object.assign(de,{__name:"uf-widget-form",setup(e){const t=(0,s.l1)().use;return(e,l)=>{const i=(0,s.up)("q-input"),o=(0,s.up)("q-form");return(0,s.wg)(),(0,s.j4)(o,{greedy:"",ref:e=>{(0,a.SU)(t).refForm(e)}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).active_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},[e.class.includes("CharField")?((0,s.wg)(),(0,s.j4)(i,{key:0,class:"q-pb-sm",dense:"",outlined:"",modelValue:(0,a.SU)(t).data.item[e.name],"onUpdate:modelValue":l=>(0,a.SU)(t).data.item[e.name]=l,label:e.verbose_name,rules:(0,a.SU)(t).getRules(e.name),"lazy-rules":"ondemand"},null,8,["modelValue","onUpdate:modelValue","label","rules"])):(0,s.kq)("",!0),e.class.includes("IntegerField")?((0,s.wg)(),(0,s.j4)(i,{key:1,class:"q-pb-sm",dense:"",outlined:"",type:"number",modelValue:(0,a.SU)(t).data.item[e.name],"onUpdate:modelValue":l=>(0,a.SU)(t).data.item[e.name]=l,label:e.verbose_name,rules:(0,a.SU)(t).getRules(e.name),"lazy-rules":"ondemand"},null,8,["modelValue","onUpdate:modelValue","label","rules"])):(0,s.kq)("",!0)])))),128))])),_:1},512)}}});var me=l(6611);const pe=ce,he=pe;U()(ce,"components",{QForm:P.Z,QInput:me.Z});const _e={class:"row"},ge={class:"row"},we={key:0,class:"col-auto text-body"},fe={key:1,class:"col-auto text-body"},ve={class:"col-auto"},be={inheritAttrs:!1},ye=Object.assign(be,{__name:"uf-widget-info",setup(e){const t=(0,s.l1)().use;return(e,l)=>{const i=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",_e,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).active_s,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"widget-info-col col-lg-3 col-md-6 col-sm-12",key:e.id},[(0,s._)("h6",null,(0,d.zw)(e.verbose_name),1),(0,s._)("div",ge,[(0,a.SU)(t).data.item[e.column_name]?((0,s.wg)(),(0,s.iD)("div",we,(0,d.zw)((0,a.SU)(t).data.item[e.column_name]),1)):((0,s.wg)(),(0,s.iD)("div",fe,"null "+(0,d.zw)(e.verbose_name),1)),(0,s._)("div",ve,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).dialog_s,(l=>((0,s.wg)(),(0,s.iD)("span",{key:l.id},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.widget_s,(o=>((0,s.wg)(),(0,s.iD)("span",{key:o.key},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.active_s,(o=>((0,s.wg)(),(0,s.iD)("span",{key:o.name},["item-menu"==l.activator&&e.column_name==o.column_name?((0,s.wg)(),(0,s.j4)(i,{key:0,class:"widget-info-col-btn",round:"",dense:"",flat:"",size:"xs",icon:l.icon,onClick:e=>(0,a.SU)(t).ref[l.id].showDialog((0,a.SU)(t).data.item,"item",(0,a.SU)(t).data.source)},null,8,["icon","onClick"])):(0,s.kq)("",!0)])))),128))])))),128))])))),128))])])])))),128))])}}}),ke=ye,Ue=ke;U()(ye,"components",{QBtn:b.Z});const qe={inheritAttrs:!1},Se=Object.assign(qe,{__name:"uf-widget-table",setup(e){const t=(0,s.l1)().use;function l(){let e=[];return e.push({name:"gotos",label:"",field:"gotos"}),e.push({name:"actions",label:"",filed:"actions"}),t.active_s.forEach((t=>{var l={};l=t.class.includes("ForeignKeyField")?{name:t.column_name,label:t.verbose_name,field:function(e){return e[t.name]?e[t.name]["title"]:null},sortable:!0}:{name:t.column_name,label:t.verbose_name,field:t.column_name,sortable:!0},e.push(l)})),e}return t.item_s_mode=!0,(e,i)=>{const o=(0,s.up)("q-table");return(0,s.wg)(),(0,s.j4)(o,{columns:l(),rows:(0,a.SU)(t).data.item_s,flat:""},null,8,["columns","rows"])}}});var We=l(7580);const je=Se,De=je;U()(Se,"components",{QTable:We.Z});const Qe={__name:"uf-widget",props:{id:{}},setup(e){const t=e,l=(0,a.qj)(new x(t.id));return(e,t)=>((0,s.wg)(),(0,s.j4)(ie,{use:l},{"widget-content":(0,s.w5)((()=>["default"==l.type?((0,s.wg)(),(0,s.j4)(re,{key:0,use:l},null,8,["use"])):(0,s.kq)("",!0),"form"==l.type?((0,s.wg)(),(0,s.j4)(he,{key:1,use:l},null,8,["use"])):(0,s.kq)("",!0),"info"==l.type?((0,s.wg)(),(0,s.j4)(Ue,{key:2,use:l},null,8,["use"])):(0,s.kq)("",!0),"table"==l.type?((0,s.wg)(),(0,s.j4)(De,{key:3,use:l},null,8,["use"])):(0,s.kq)("",!0)])),_:1},8,["use"]))}},Ze=Qe,Fe=Ze,Ve={inheritAttrs:!1},Ce=Object.assign(Ve,{__name:"uf-dialog-standard",setup(e){const t=(0,s.l1)().use;return(e,l)=>((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).widget_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},[(0,s.Wm)(Fe,{id:e.id},null,8,["id"]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.widget_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},[(0,s.Wm)(Fe,{id:e.id},null,8,["id"])])))),128))])))),128))}}),xe=Ce,Ee=xe,Ke={__name:"uf-dialog",props:{id:{}},setup(e){const t=e,l=(0,a.qj)(new r(t.id));return(e,t)=>((0,s.wg)(),(0,s.j4)(Z,{use:l},{"dialog-content":(0,s.w5)((()=>["standard"==l.type?((0,s.wg)(),(0,s.j4)(Ee,{key:0,use:l},null,8,["use"])):(0,s.kq)("",!0)])),_:1},8,["use"]))}},He=Ke,ze=He;class Oe{constructor(e){this.rowsPerPageOptions=[4,8,16,32,64,128,265,512,1024],this.rowsPerPage=e,this.page=1}}class Ie extends i.y{constructor(e){super(e),this.ql={},this.route=(0,o.yj)(),this.data=(0,a.qj)(new F(this.uniform.source[this.source_id],{...this.query,...this.route.query})),this.pagination=(0,a.qj)(new Oe(this.pag_recs)),this.item_menu_target=!1,this.item_menu_model=!1,this.item_menu_row={}}get column_s(){let e=[];return e.push({name:"gotos",label:"",field:"gotos"}),e.push({name:"actions",label:"",filed:"actions"}),this.active_s.forEach((t=>{var l={};l=t.class.includes("ForeignKeyField")?{name:t.column_name,label:t.verbose_name,field:function(e){return e[t.name]?e[t.name]["title"]:null},sortable:!0}:{name:t.column_name,label:t.verbose_name,field:t.column_name,sortable:!0},e.push(l)})),e}get rel_view_s(){let e=[];return this.uniform.meta.app.base_s.forEach((t=>{t.view_s.forEach((t=>{this.uniform.source[t.source_id].field_s.forEach((l=>{l.class.includes("ForeignKeyField")&&this.data.source.model==l.rel_model&&e.push({id:t.id,icon:t.icon,title:t.title,parent_id:t.parent_id,rel_field_name:l.name})}))}))})),e}onItemClick(e,t,l){if("td"==e.target.localName)for(const s of this.dialog_s)if("item-click"==s.activator){this.ref[s.id].showDialog(t,"item",this.data.source);break}}onItemMenuClick(e,t){this.item_menu_target=e.target,this.item_menu_model=!0,this.item_menu_row=t}}const Ae={inheritAttrs:!1},Ye=Object.assign(Ae,{__name:"uf-view-item-menu",setup(e){const t=(0,s.l1)().use,l=(0,u.j)();return(e,i)=>{const o=(0,s.up)("q-icon"),n=(0,s.up)("q-item-section"),u=(0,s.up)("q-item"),r=(0,s.up)("q-list"),c=(0,s.up)("q-menu");return(0,s.wg)(),(0,s.j4)(c,{"auto-close":"",target:(0,a.SU)(t).item_menu_target,modelValue:(0,a.SU)(t).item_menu_model,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,a.SU)(t).item_menu_model=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).dialog_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},["item-menu"==e.activator?((0,s.wg)(),(0,s.j4)(u,{key:0,dense:"",clickable:"",onClick:l=>(0,a.SU)(t).ref[e.id].showDialog((0,a.SU)(t).item_menu_row,"item",(0,a.SU)(t).data.source)},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{name:e.icon},null,8,["name"])])),_:2},1024),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):(0,s.kq)("",!0)])))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).action_s,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id},["item-menu"==e.activator?((0,s.wg)(),(0,s.j4)(u,{key:0,dense:"",clickable:"",onClick:s=>(0,a.SU)(l).sendAction(e,(0,a.SU)(t).item_menu_row,[])},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{name:e.icon},null,8,["name"])])),_:2},1024),(0,s.Wm)(n,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):(0,s.kq)("",!0)])))),128))])),_:1})])),_:1},8,["target","modelValue"])}}});var Pe=l(6362),Te=l(3246),Be=l(490),Me=l(1233);const Re=Ye,Le=Re;U()(Ye,"components",{QMenu:Pe.Z,QList:Te.Z,QItem:Be.Z,QItemSection:Me.Z,QIcon:ee.Z});const $e={class:"row full-width items-center"},Ne={class:"col-auto"},Ge={class:"col-auto"},Je={key:0,class:"col"},Xe={key:1,class:"col"},et={key:2,class:"col full-width"},tt={class:"row full-width items-center"},lt={class:"col-auto"},st={class:"col"},at={class:"col-auto"},it={inheritAttrs:!1},ot=Object.assign(it,{__name:"uf-view-filter",setup(e){const t=(0,s.l1)().use,l=(0,o.tv)(),i=(0,o.yj)(),n=(0,a.iH)(null),u=(0,a.iH)(null),r=(0,a.iH)("eq"),d=(0,a.iH)(null);function c(){n.value&&!u.value?(n.value=null,g.value=null,d.value=null):n.value&&u.value&&(u.value=null,g.value=null,d.value=null)}const m=(0,s.Fl)((()=>{let e=!1;return!n.value||"ForeignKeyField"!=n.value.class&&"BackRefMetaField"!=n.value.class&&"ManyToManyField"!=n.value.class||(e=!0),e})),p=(0,s.Fl)((()=>{let e=[];return t.filter_s.forEach((l=>{let s=!1;Object.entries(t.data.query).forEach((([e])=>{e.includes(l.name)&&"ForeignKeyField"!=l.class&&(s=!0)})),s||e.push(l)})),e})),h=(0,s.Fl)((()=>{let e,l=[];if("ForeignKeyField"==n.value.class)e=n.value.rel_model;else{let l=t.data.source.rel_field_s.filter((e=>"ForeignKeyField"==e.class&&e.backref==n.value.ref_name||"ManyToManyField"==e.class&&e.name==n.value.ref_name))[0];e="ForeignKeyField"==l.class?l.model:l.rel_model}let s=t.uniform.getSourceByModel(e);return s.field_s.forEach((e=>{let s=!1;Object.entries(t.data.query).forEach((([t])=>{t.includes(e.name)&&(s=!0)})),s||"ForeignKeyField"!=e.class&&l.push(e)})),l})),_=(0,s.Fl)((()=>{let e=[{name:"eq",verbose_name:"==",types:"*"}],t=[];return n.value&&e.forEach((e=>{"*"==e.types&&t.push(e),e.types.includes(n.value.class)&&t.push(e)})),t})),g=(0,a.iH)(null);function w(){let e=i.query;n.value&&!m.value?t.data.source.getOptions(e,n.value.name,null).then((e=>{g.value=e.data})):u.value&&m.value&&("ForeignKeyField"==n.value.class?t.data.source.getOptions(e,n.value.name,u.value.name).then((e=>{g.value=e.data})):t.data.source.getOptions(e,n.value.ref_name,u.value.name).then((e=>{g.value=e.data})))}function f(){let e={...i.query},t="";m.value?m.value&&(t="ForeignKeyField"==n.value.class?t+n.value.name+"__"+u.value.name:t+n.value.ref_name+"__"+u.value.name):t=n.value.name,t=t+"__"+r.value,e[t]=d.value,l.push({path:i.path,query:e})}return(e,l)=>{const o=(0,s.up)("q-btn"),v=(0,s.up)("q-select");return(0,s.wg)(),(0,s.iD)("div",$e,[(0,s._)("div",Ne,[(0,s.Wm)(o,{class:"float-right text-black",dense:"",round:"",flat:"",icon:"mdi-content-save",onClick:l[0]||(l[0]=e=>(0,a.SU)(t).uniform.queries.saveQuery((0,a.SU)(i)))})]),(0,s._)("div",Ge,[(0,s.Wm)(o,{class:"float-right text-black",dense:"",round:"",flat:"",icon:"mdi-undo",onClick:l[1]||(l[1]=e=>c()),disable:!n.value},null,8,["disable"])]),n.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Je,[(0,s.Wm)(v,{dense:"",outlined:"",modelValue:n.value,"onUpdate:modelValue":[l[2]||(l[2]=e=>n.value=e),l[3]||(l[3]=e=>w())],options:(0,a.SU)(p),"option-value":"name","option-label":"verbose_name","options-dense":"",label:"Select field for filtering",style:{width:"100%"}},null,8,["modelValue","options"])])),(0,a.SU)(m)&&n.value&&!u.value?((0,s.wg)(),(0,s.iD)("div",Xe,[(0,s.Wm)(v,{dense:"",outlined:"",modelValue:u.value,"onUpdate:modelValue":[l[4]||(l[4]=e=>u.value=e),l[5]||(l[5]=e=>w())],options:(0,a.SU)(h),"option-value":"name","option-label":"verbose_name","options-dense":"",label:"Select related field for filtering",style:{width:"100%"}},null,8,["modelValue","options"])])):(0,s.kq)("",!0),(0,a.SU)(m)&&n.value&&u.value||!(0,a.SU)(m)&&n.value?((0,s.wg)(),(0,s.iD)("div",et,[(0,s._)("div",tt,[(0,s._)("div",lt,[(0,s.Wm)(v,{dense:"",outlined:"",modelValue:r.value,"onUpdate:modelValue":l[6]||(l[6]=e=>r.value=e),options:(0,a.SU)(_),"option-value":"name","option-label":"verbose_name","options-dense":"","map-options":"","emit-value":""},null,8,["modelValue","options"])]),(0,s._)("div",st,["eq"==r.value?((0,s.wg)(),(0,s.j4)(v,{key:0,dense:"",outlined:"",modelValue:d.value,"onUpdate:modelValue":l[7]||(l[7]=e=>d.value=e),multiple:"",options:g.value,"options-dense":"",label:"Select value for filtering",style:{width:"100%"},disable:!g.value,loading:!g.value},null,8,["modelValue","options","disable","loading"])):(0,s.kq)("",!0)])])])):(0,s.kq)("",!0),(0,s._)("div",at,[(0,s.Wm)(o,{class:"float-right text-black",dense:"",round:"",flat:"",icon:"mdi-database-search",onClick:l[8]||(l[8]=e=>f()),disable:!d.value},null,8,["disable"])])])}}});var nt=l(2762);const ut=ot,rt=ut;U()(ot,"components",{QBtn:b.Z,QSelect:nt.Z});const dt={class:"row full-width row items-center"},ct={class:"col-2"},mt={class:"col-6"},pt={class:"col-4"},ht={class:"row items-center"},_t={class:"col-2"},gt={class:"col"},wt={class:"row full-width items-center"},ft={inheritAttrs:!1},vt=Object.assign(ft,{__name:"uf-view-header",setup(e){const t=(0,s.l1)().use,l=(0,o.yj)();return(e,i)=>{const o=(0,s.up)("q-btn-dropdown"),n=(0,s.up)("q-btn"),u=(0,s.up)("q-input"),r=(0,s.up)("q-toolbar"),d=(0,s.up)("q-chip");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s._)("div",dt,[(0,s._)("div",ct,[(0,s.Wm)(o,{class:"text-black",flat:"",align:"left",icon:"menu_open"})]),(0,s._)("div",mt,[(0,s.Wm)(rt,{use:(0,a.SU)(t)},null,8,["use"])]),(0,s._)("div",pt,[(0,s._)("div",ht,[(0,s._)("div",_t,[(0,s.Wm)(n,{class:"float-right text-black",dense:"",round:"",flat:"",icon:"clear",disable:!(0,a.SU)(t).data.search,onClick:i[0]||(i[0]=e=>(0,a.SU)(t).data.search=null)},null,8,["disable"])]),(0,s._)("div",gt,[(0,s.Wm)(u,{class:"text-black",dense:"",outlined:"",modelValue:(0,a.SU)(t).data.search,"onUpdate:modelValue":i[1]||(i[1]=e=>(0,a.SU)(t).data.search=e),label:"Fast search in "+(0,a.SU)(t).title},null,8,["modelValue","label"])])])])])])),_:1}),(0,s._)("div",wt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(l).query,((e,t)=>((0,s.wg)(),(0,s.j4)(d,{label:t+"="+e,key:t},null,8,["label"])))),128))])],64)}}});var bt=l(8479),yt=l(7691);const kt=vt,Ut=kt;U()(vt,"components",{QToolbar:w.Z,QBtnDropdown:bt.Z,QBtn:b.Z,QInput:me.Z,QChip:yt.Z});const qt={class:"row items-center"},St={class:"view-footer-pagination col-auto"},Wt={class:"col-auto"},jt={inheritAttrs:!1},Dt=Object.assign(jt,{__name:"uf-view-footer",setup(e){const t=(0,s.l1)().use,l=(0,s.Fl)((()=>{let e=Math.ceil(t.data.count/t.pagination.rowsPerPage);return e}));return(e,i)=>{const o=(0,s.up)("q-space"),n=(0,s.up)("q-pagination"),u=(0,s.up)("q-select"),r=(0,s.up)("q-toolbar");return(0,s.wg)(),(0,s.j4)(r,{class:"bg-grey-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(o),(0,s._)("div",qt,[(0,s._)("div",St,[(0,s.Wm)(n,{modelValue:(0,a.SU)(t).pagination.page,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,a.SU)(t).pagination.page=e),max:(0,a.SU)(l),"direction-links":"","boundary-links":"",color:"black"},null,8,["modelValue","max"])]),(0,s._)("div",Wt,[(0,s.Wm)(u,{modelValue:(0,a.SU)(t).pagination.rowsPerPage,"onUpdate:modelValue":i[1]||(i[1]=e=>(0,a.SU)(t).pagination.rowsPerPage=e),options:(0,a.SU)(t).pagination.rowsPerPageOptions,dense:"",outlined:""},null,8,["modelValue","options"])])])])),_:1})}}});var Qt=l(996);const Zt=Dt,Ft=Zt;U()(Dt,"components",{QToolbar:w.Z,QSpace:v.Z,QPagination:Qt.Z,QSelect:nt.Z});const Vt={inheritAttrs:!1},Ct=Object.assign(Vt,{__name:"uf-view-layout",setup(e){const t=(0,s.l1)().use,l=(0,s.Fl)((()=>{let e="0 px";return t.ql.hasOwnProperty("header")&&(e=t.ql.header.size+"px"),e}));return(e,i)=>{const o=(0,s.up)("q-header"),n=(0,s.up)("q-footer"),u=(0,s.up)("q-layout");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(Le,{use:(0,a.SU)(t)},null,8,["use"]),(0,s.Wm)(u,{container:"",style:{height:"calc(100vh - 102px)"}},{default:(0,s.w5)((()=>[(0,s.Wm)(c.Z,{use:(0,a.SU)(t)},null,8,["use"]),(0,s.Wm)(o,{reveal:"",class:"bg-white"},{default:(0,s.w5)((()=>[(0,s.Wm)(Ut,{use:(0,a.SU)(t)},null,8,["use"])])),_:1}),(0,s._)("div",{class:"view-content",style:(0,d.j5)({"padding-top":(0,a.SU)(l)})},[(0,s.WI)(e.$slots,"view-content")],4),(0,s.Wm)(n,{reveal:""},{default:(0,s.w5)((()=>[(0,s.Wm)(Ft,{use:(0,a.SU)(t)},null,8,["use"])])),_:1})])),_:3})],64)}}}),xt=Ct,Et=xt;U()(Ct,"components",{QLayout:_.Z,QHeader:g.Z,QFooter:y.Z});const Kt={inheritAttrs:!1},Ht=Object.assign(Kt,{__name:"uf-view-table",setup(e){const t=(0,s.l1)().use;t.data.setItems();const l=(0,s.Fl)((()=>{let e=16,l="0 px";return e+=t.ref.app.ql.header.size,e+=t.ref.app.ql.footer.size,e+=t.ql.header.size,e+=t.ql.footer.size,l="calc(100vh - "+e+"px)",l}));return(e,i)=>{const o=(0,s.up)("q-item-section"),n=(0,s.up)("q-item"),u=(0,s.up)("q-list"),r=(0,s.up)("q-menu"),c=(0,s.up)("q-btn"),m=(0,s.up)("q-td"),p=(0,s.up)("q-table");return(0,s.wg)(),(0,s.j4)(p,{columns:(0,a.SU)(t).column_s,filter:(0,a.SU)(t).data.search,rows:(0,a.SU)(t).data.item_s,style:(0,d.j5)({height:(0,a.SU)(l)}),class:"sticky-header-table",dense:"",flat:"","hide-bottom":"","row-key":"id",selection:"multiple",pagination:(0,a.SU)(t).pagination,"onUpdate:pagination":i[0]||(i[0]=e=>(0,a.SU)(t).pagination=e),selected:(0,a.SU)(t).data.select_s,"onUpdate:selected":i[1]||(i[1]=e=>(0,a.SU)(t).data.select_s=e),onRowClick:i[2]||(i[2]=(e,l,s)=>{(0,a.SU)(t).onItemClick(e,l,s)})},{"body-cell-gotos":(0,s.w5)((e=>[(0,s.Wm)(m,{props:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{dense:"",round:"",flat:"",icon:"mdi-link"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{"auto-close":""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(t).rel_view_s,(t=>((0,s.wg)(),(0,s.j4)(n,{dense:"",key:t.id,to:"/"+t.parent_id+"/"+t.id+"?"+t.rel_field_name+"__eq="+e.row.id},{default:(0,s.w5)((()=>[(0,s.Wm)(o,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)("view "+t.title+" from "+e.row.title),1)])),_:2},1024)])),_:2},1032,["to"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),"body-cell-actions":(0,s.w5)((e=>[(0,s.Wm)(m,{props:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{dense:"",round:"",flat:"",icon:"mdi-dots-vertical",onClick:l=>{(0,a.SU)(t).onItemMenuClick(l,e.row)}},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["columns","filter","rows","style","pagination","selected"])}}});var zt=l(7220);const Ot=Ht,It=Ot;U()(Ht,"components",{QTable:We.Z,QTd:zt.Z,QBtn:b.Z,QMenu:Pe.Z,QList:Te.Z,QItem:Be.Z,QItemSection:Me.Z});const At={__name:"uf-view",props:{id:{}},setup(e){const t=e,l=(0,a.qj)(new Ie(t.id));return(0,s.bv)((()=>{for(const e of l.dialog_s)if("none"==e.activator){l.ref[e.id].showDialog({},"last",l.data.source);break}})),(e,t)=>((0,s.wg)(),(0,s.j4)(Et,{use:l},{"view-content":(0,s.w5)((()=>["table"==l.type?((0,s.wg)(),(0,s.j4)(It,{key:0,use:l},null,8,["use"])):(0,s.kq)("",!0)])),_:1},8,["use"]))}},Yt=At,Pt=Yt,Tt={key:0},Bt={__name:"uf-base",setup(e){const t=(0,o.yj)(),l=(0,a.qj)(new n(t.params.base_id));return(e,t)=>{const a=(0,s.up)("q-page");return(0,s.wg)(),(0,s.iD)(s.HY,null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.route_dialog_s,(e=>((0,s.wg)(),(0,s.j4)(ze,{key:e.id,id:e.id},null,8,["id"])))),128)),(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[l.getView().id?((0,s.wg)(),(0,s.iD)("span",Tt,[(0,s.Wm)(Pt,{id:l.getView().id},null,8,["id"])])):(0,s.kq)("",!0)])),_:1})],64)}}};var Mt=l(9885);const Rt=Bt,Lt=Rt;U()(Bt,"components",{QPage:Mt.Z})}}]);